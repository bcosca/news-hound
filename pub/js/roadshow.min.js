"use strict";!function(t){"function"==typeof define&&define.amd?define(t):"object"==typeof module&&module.exports?module.exports=t():window.roadshow=t()}(function(){let t="tag",e="ref",r="glue",n={};function traverse(t,e){let r=e,n=!1;for(;r;)if(n||(t.pre&&t.pre(r,n),!r.firstElementChild)){if(t.post&&t.post(r,n),r.isSameNode(e))break;n=!1,r.nextElementSibling?r=r.nextElementSibling:(n=!0,r=r.parentElement)}else n=!1,r=r.firstElementChild}function $(t,e){return[].slice.call((e||document).querySelectorAll(t))}function Props(t){t&&this.save(t)}function Ref(e,r){let n=this;Object.setPrototypeOf(this,{on(t,e,r){return t.split(" ").forEach(function(t){this._raw.addEventListener(t,e.bind(this),r)}.bind(this)),this},off(t,e,r){return t.split(" ").forEach(function(t){this._raw.removeEventListener(t,e.bind(this),r)}.bind(this)),this},once(t,e,r){return t.split(" ").forEach(function(t){var n=function(){e.call(this),this._raw.removeEventListener(t,n,r)}.bind(this);this._raw.addEventListener(t,n,r)}.bind(this)),this},emit(t,e){return t.split(" ").forEach(function(r){this._raw.dispatchEvent(new CustomEvent(t,{detail:e}))}.bind(this)),this},find(t){let e=[];return $(t,this._raw).forEach(function(t){e.push(new Ref(t))}),e},next(t){let e,r=this._raw;for(;(e=r.nextElementSibling)&&t&&!e.matches(t);)r=r.nextElementSibling;return e?new Ref(e):void 0},prev(t){let e,r=this._raw;for(;(e=r.previousElementSibling)&&t&&!e.matches(t);)r=r.previousElementSibling;return e?new Ref(e):void 0},inject(t){let e=this._raw;if(e._props){let r=e._props,n=!1;for(let e in t)if(r.hasOwnProperty(e)&&t.hasOwnProperty(e)&&r[e]!=t[e]){n=!0;break}e._props.save(t),escalate(e),n&&traverse({pre(e){e._props&&(e._props.save(t),e.dispatchEvent(new CustomEvent("update")))}},e)}else e._props=new Props(t);return this},expose(t){return t||(t=this),t._raw&&this._raw.contains(t._raw)?t._raw:void 0},unload(){return unload(this._raw),this},load(t){let e=this._raw;return load(t||e._props,e),this},reload(t){return this.unload(),this.load(t),this},ref(t){for(var e in this._raw._refs)if(this._raw._refs[e]._raw.isSameNode(t))return this._raw._refs[e];return new Ref(t)},tag:{add(e){let r=n._raw,i=r.getAttribute(t);(!i||i.split(" ").indexOf(e)<0)&&r.setAttribute(t,((i||"")+" "+e).trim());let s=r.parentElement;for(;s&&!s._props;)s=s.parentElement;return r._props||(r._props=new Props),s&&r._props.save(s._props),n},remove(e){let r=n._raw,i=r.getAttribute(t),s=new RegExp("(?<=^|s)"+e+"(?=s|$)");return r.setAttribute(t,i.replace(s,"")),n}},empty(){let t=this._raw;for(;t.firstChild;)t.firstChild.remove();return this},css(t){let e=this._raw;switch(typeof t){case"object":for(var r in t)e.style[r]=t[r];return this;case"string":return e.style[t];default:return JSON.parse(JSON.stringify(e.style))}},attr(t){let e=this._raw;switch(typeof t){case"object":for(var r in t)e.setAttribute(r,t[r]);return this;case"string":return e.getAttribute(t);default:let n={};for(let t=0,r=e.attributes,i=r.length;t<i;t++)n[r[t].name]=r[t].value;return n}},class:{add:t=>(t.split(" ").forEach(function(t){n._raw.classList.add(t)}),n),remove:t=>(t.split(" ").forEach(function(t){n._raw.classList.remove(t)}),n),toggle:(t,e)=>(t.split(" ").forEach(function(t){n._raw.classList.toggle(t,e)}),n)},html(t){let e=this._raw;return t?(e.innerHTML=t,this):e.innerHTML},text(t){let e=this._raw;return t?(e.textContent=t,this):e.textContent},_raw:e}),Object.setPrototypeOf(this.attr,{remove:t=>(n._raw.removeAttribute(t),n)}),r&&r.call(this,e._props,e._refs)}function escalate(t){let e=t._parent;if(e)for(let r in e._refs)if(t.isSameNode(e._refs[r]._raw)){for(let n in t._props)t._props.hasOwnProperty(n)&&(e._refs[r][n]=t._props[n]);t.isSameNode(e)&&escalate(e);break}}function load(i,s){s=s||document.documentElement;let o,a=[];traverse({pre(s){s.hasAttribute(t)&&(s.getAttribute(t).split(" ").forEach(function(l){if(n[l]){if(o=a[a.length-1])for(;!o.contains(s);)a.pop(),o=a[a.length-1];s._parent=o,s._props=s._props||new Props,s._props.save(o?o._props:i,!1),s._refs={},o&&escalate(s),a.push(s),function instantiate(i){(!s._tag||s._tag.split(" ").indexOf(i)<0)&&(s._tag=((s._tag||"")+" "+i).trim());let o=new Ref(s,n[i].fn),a=n[i].css;!a.loaded&&a.content&&(function style(t,e){let r=e.call(this,t).trim();if(r){let t=document.createElement("style");t.textContent=r,document.head.appendChild(t)}}.call(o,s._props,a.content),a.loaded=!0);let l=document.createElement("template");l.innerHTML=n[i].html.call(o,s._props);let f=document.createDocumentFragment(),p=$(r,l.content);if(p.length){for(;s.firstChild;)f.appendChild(s.firstChild);p[0].parentElement.replaceChild(f,p[0]),p.forEach(function(t){t.remove()})}let u=l.content.firstElementChild;for(!function merge(t,e){let r=t.attributes;for(let t=0,n=r.length;t<n;t++)r[t].value=r[t].value.trim(),"class"==r[t].name?e.classList.add.apply(e.classList,r[t].value.split(" ")):e.setAttribute(r[t].name,r[t].value)}(u,s);u.firstChild;)u.firstChild.nodeType!=window.Node.TEXT_NODE||u.firstChild.textContent.trim()?f.appendChild(u.firstChild):u.firstChild.remove();s.insertBefore(f,s.firstElementChild);let h=$("["+e+"]",s);s.hasAttribute(e)&&h.push(s),h.forEach(function(t){s._refs[t.getAttribute(e)]=new Ref(t),t.removeAttribute(e)}),u.hasAttribute(t)&&u.getAttribute(t).split(" ").forEach(function(t){instantiate(t)})}(l)}}),s.dispatchEvent(new CustomEvent("ready")),s.removeAttribute(t))}},s)}function unload(e){traverse({post(e){for(e.dispatchEvent(new CustomEvent("unload")),!e.getAttribute(t)&&e._tag&&(e.setAttribute(t,e._tag),delete e._tag);e.lastChild;)e.removeChild(e.lastChild)}},e||window.document.documentElement)}return Props.prototype={save(t,e){if(e=null==e||e,"object"==typeof t)for(let r in t)t.hasOwnProperty(r)&&(!this.hasOwnProperty(r)||e)&&(this[r]=t[r])}},{register(t,e,r,i){r.prototype=Ref,n[t]={html:e,fn:r,css:{content:i,loaded:!1}}},$:$,load:load,unload:unload}});
//# sourceMappingURL=roadshow.min.js.map