<news:item tag="cc:card" class="flex my-2">
  <style>
  .card {
    background-color:var(${ props.app.storage.darkMode?'--shaded':'--surface' }) !important;
  }
  a {
    color:${ props.css.foreground(props.theme.surface) };
  }
  </style>
  <script>
  function timeDiff(time,ref) {
    let format=window.ICU.format,
        message=chrome.i18n.getMessage;
    if (!ref)
      // Get current time if second argument is not specified
      ref=Date.now()/1e3;
    let diff=time-ref,
        abs=Math.abs(diff);
    if (!abs)
      return message('timeNow');
    let when=message(diff>0?'timeFuture':'timePast'),
        units={
          year:31.536e6,
          month:2.592e6,
          week:604.8e3,
          day:86.4e3,
          hour:3.6e3,
          minute:60
        },
        unit;
    for (let i in units)
      if (abs>=units[i]) {
        unit=Math.trunc(abs/units[i]);
        return /day/.test(i) && !(unit-1)?
          message(diff>0?'timeTomorrow':'timeYesterday'):
          format(
            when,
            format(
              message('time'+i[0].toUpperCase()+i.substring(1)),
              unit
            )
          );
      }
    return format(
      when,
      format(
        message('timeSecond'),
        Math.trunc(abs))
    );
  }
  let $=roadshow.$;

  // Extract RSS elements
  let desc=$('description',props.item).shift(),
      photo=$('content',props.item).shift(),
      pub=new Date($('pubDate',props.item).shift().textContent),
      tmp=document.createElement('template');
  tmp.innerHTML=(
    desc.textContent.
      replace(/<(\/)?ol>/,'<$1ul>').
      replace(/&nbsp;/g,' ')
  );
  let headline=document.createElement('div'),
      first;
  if (/^ul/i.test(tmp.content.firstElementChild.tagName)) {
    // Restructure HTML
    first=$('li:first-child',tmp.content).shift();
    while (first.firstChild)
      headline.appendChild(first.firstChild);
    tmp.content.insertBefore(headline,tmp.content.firstElementChild);
    first.remove();
    // Remove link to Google News page
    $('li:last-child',tmp.content).shift().remove();
  }
  else {
    while (tmp.content.firstChild) {
      if (tmp.content.firstChild.nodeType==window.Node.ELEMENT_NODE &&
          /^p/i.test(tmp.content.firstChild.tagName))
        break;
      headline.appendChild(tmp.content.firstChild);
    }
    tmp.content.insertBefore(headline,tmp.content.firstElementChild);
  }

  // Tweak formatting
  $('strong',tmp.content).forEach(function(element) {
    element.remove();
  });
  $('p,ul',tmp.content).forEach(function(element) {
    element.setAttribute('class','small mt-1 mb-0');
    if (element.matches('ul'))
      element.classList.add('pl-2');
  });
  $('font',tmp.content).forEach(function(element) {
    element.setAttribute('class','text-muted');
    element.removeAttribute('color');
    if (!element.parentElement || element.parentElement.isSameNode(headline)) {
      element.classList.add('small');
      // Add human-readable timestamp
      element.textContent+=' Â· '+timeDiff(pub.getTime()/1e3);
    }
  });

  // Wrap news item in a div element
  let item=this.expose(),
      div=document.createElement('div');
  div.setAttribute('class','grow m-2');
  div.appendChild(tmp.content);
  item.appendChild(div);

  if (photo) {
    let img=this.getRef(item.appendChild(document.createElement('img')));
    img.attr({
      src:photo.getAttribute('url').replace(/(\-[wh])150/g,'$196'),
      width:96,
      height:72,
      class:'noflex cover mr-2 my-2'
    });
  }
  </script>
</news:item>

<a href="https://news.google.com/__i/rss/rd/articles/CBMibmh0dHBzOi8vbmV3c2luZm8uaW5xdWlyZXIubmV0LzExMjk0NTMvc3RyaXBwaW5nLW9mLWF1dGhvcml0eS1hbmRhbmFyLWlzc3Vlcy1vcmRlci1vbi1waWEtYW1pZC1wcm9iZS1vbi1jbGF2aXRl0gEA?oc=5" target="_blank">'Stripping' of authority? Andanar issues order on PIA amid probe on Clavite</a>
<font color="#6f6f6f">INQUIRER.net</font>
<p>Communications Secretary Martin Andanar has issued a department order saying the Presidential Communications Operations Office (PCOO) would be the ...</p>
